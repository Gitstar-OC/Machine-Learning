Let's look at our second unsupervised learning algorithm. Anomaly detection algorithms look at an unlabeled dataset of normal events and thereby learns to detect or to raise a red flag for if there is an unusual or an anomalous event. Let's look at an example. Some of my friends were working on using anomaly detection to detect possible problems with aircraft engines that were being manufactured. When a company makes an aircraft engine, you really want that aircraft engine to be reliable and function well because an aircraft engine failure has very negative consequences. So some of my friends were using anomaly detection to check if an aircraft engine after it was manufactured seemed anomalous or if there seemed to be anything wrong with it.
Play video starting at ::58 and follow transcript0:58
Here's the idea, after an aircraft engine rolls off the assembly line, you can compute a number of different features of the aircraft engine. So, say feature x1 measures the heat generated by the engine. Feature x2 measures the vibration intensity and so on and so forth for additional features as well. But to simplify the slide a bit, I'm going to use just two features x1 and x2 corresponding to the heat and the vibrations of the engine.
Play video starting at :1:30 and follow transcript1:30
Now, it turns out that aircraft engine manufacturers don't make that many bad engines. And so the easier type of data to collect would be if you have manufactured m aircraft engines to collect the features x1 and x2 about how these m engines behave and probably most of them are just fine that normal engines rather than ones with a defect or flaw in them.
Play video starting at :2: and follow transcript2:00
And the anomaly detection problem is, after the learning algorithm has seen these m examples of how aircraft engines typically behave in terms of how much heat is generated and how much they vibrate. If a brand new aircraft engine were to roll off the assembly line and it had a new feature vector given by Xtest, we'd like to know does this engine look similar to ones that have been manufactured before? So is this probably okay? Or is there something really weird about this engine which might cause this performance to be suspect, meaning that maybe we should inspect it even more carefully before we let it get shipped out and be installed in an airplane and then hopefully nothing will go wrong with it. Here's how an anomaly detection algorithm works. Let me plot the examples x1 through xm over here via these crosses where each cross each data point in this plot corresponds to a specific engine with a specific amount of heat and specific amount of vibrations. If this new aircraft engine Xtest rolls off the assembly lin,e and if you were to plot these values of x1 and x2 and if it were here, you say, okay, that looks probably okay. Looks very similar to other aircraft engines. Maybe I don't need to worry about this one.
Play video starting at :3:33 and follow transcript3:33
But if this new aircraft engine has a heat and vibration signature that is say all the way down here, then this data point down here looks very different than ones we saw up on top. And so we will probably say, boy, this looks like an anomaly. This doesn't look like the examples I've seen before, we better inspect this more carefully before we let this engine get installed on an airplane. How can you have an algorithm address this problem? The most common way to carry out anomaly detection is through a technique called density estimation. And what that means is, when you're given your training sets of these m examples, the first thing you do is build a model for the probability of x. In other words, the learning algorithm will try to figure out what are the values of the features x1 and x2 that have high probability and what are the values that are less likely or have a lower chance or lower probability of being seen in the data set. In this example that we have here, I think it is quite likely to see examples in that little ellipse in the middle, so that region in the middle would have high probability maybe things in this ellipse have a little bit lower probability. Things in this ellipse of this oval have even lower probability and things outside have even lower probability. The details of how you decide from the training set what regions are higher versus lower probability is something we'll see in the next few videos. And having modeled or having learned to model for p of x When you are given the new test example Xtest. What you will do is then compute the probability of Xtest. And if it is small or more precisely, if it is less than some small number that I'm going to call epsilon, this is a greek alphabet epsilon. So what you should think of as a small number, which means that p of x is very small or in other words, the specific value of x that you saw for a certain user was very unlikely, relative to other usage that you have seen. But the p of Xtest is less than some small threshold or some small number epsilon, we will raise a flag to say that this could be an anomaly. So for example, if Xtest was all the way down here, the probability of an example landing all the way out here is actually quite low. And so hopefully p of Xtest for this value of Xtest will be less than epsilon and so we would flag this as an anomaly. Whereas in contrast, if p of Xtest is not less than epsilon, if p of Xtest is greater than equal to epsilon, then we will say that it looks okay, this doesn't look like an anomaly. And that response to if you had an example in here say where our model p of x will say that examples near the middle here, they're actually quite high probability. There's a very high chance that the new airplane engine will have features close to these inner ellipses. And so p of Xtest will be large for those examples and we'll say it's okay and it's not an anomaly. Anomaly detection is used today in many applications. It is frequently used in fraud detection where for example if you are running a website with many different features. If you compute xi to be the features of user i's activities. And examples of features might include, how often does this user login and how many web pages do they visit? How many transactions are they making or how many posts on the discussion forum are they making to what is their typing speed? How many characters per second do they seem able to type. With data like this you can then model p of x from data to model what is the typical behavior of a given user. In the common workflow of fraud detection, you wouldn't automatically turn off an account just because it seemed anomalous. But instead you may ask the security team to take a closer look or put in some additional security checks such as ask the user to verify their identity with a cell phone number or ask them to pass a capture to prove that they're human and so on. But algorithms like this are routinely used today to try to find unusual or maybe slightly suspicious activity. So you can more carefully screen those accounts to make sure there isn't something fraudulent. And this type of fraud detection is used both to find fake accounts and this type of algorithm is also used frequently to try to identify financial fraud such as if there's a very unusual pattern of purchases. Then that may be something well worth a security team taking a more careful look at. Anomaly detection is also frequently used in manufacturing. You saw an example on the previous slide with aircraft engine manufacturing. But many manufacturers in multiple continents in many, many factories were routinely use anomaly detection to see if whatever they just manufactured. Anything from an airplane engine to a printed circuit board to a smartphone to a motor, to many, many things to see if you've just manufactured the unit that somehow behaves strangely. Because that may indicate that there's something wrong with your airplane engine or printed circuit boards or what have you that might cause you to want to take a more careful look before you ship that object to the customer. Is also used to monitor computers in clusters and in data centers where if X I are the features of a certain machine I such as if the features captured the memory users, the number of disk accesses per second. CPU load features can also be ratios, such as the ratio of CPU load to network traffic. Then if ever a specific computer behaves very differently than other computers, it might be worth taking a look at that computer to see if something is wrong with it. Such as if it has had a hard disk failure or network card failure or something's wrong with it or if maybe it has been hacked into. Anomaly detection is one of those algorithms that is very widely used even though you don't seem to hear people talk about it that much. I remember the first time I worked on the commercial application of anomaly detection was when I was helping a telco company put in place anomaly detection to see when any one of the cell towers was behaving in an unusual way. Because that probably meant there was something wrong with the cell tower and so they want to get a technician to take so hopefully that helped more people get good cell phone coverage. And I've also used anomaly detection to find fraudulent financial transactions And these days I often use it to help manufacturing companies find anomalous parts that they may have manufactured but should inspect more often. So it is a very useful tool to have in your tool chest. And in the next few videos we'll talk about how you can build and get these algorithms to work for yourself. In order to get anonymous detection algorithms to work, we'll need to use a Gaussian distribution to model the data p of x. So, let's go on to the next video to talk about Gaussian distributions.